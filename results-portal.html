<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Results Portal - KEMZ ACADEMIC CENTRE</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="style.css">

<style>
.form-group input,
.form-group select {
    width: 100%;
    padding: 12px 15px;
    border: 2px solid #ddd;
    border-radius: 8px;
    font-size: 1rem;
}

.form-group input:focus,
.form-group select:focus {
    outline: none;
    border-color: #2874a6;
}

.btn-submit {
    width: 100%;
    background: linear-gradient(135deg, #1a5276, #2874a6);
    color: white;
    padding: 14px;
    border-radius: 50px;
    border: none;
    cursor: pointer;
    font-size: 1rem;
}

.result-container {
    display: none;
    margin-top: 30px;
}

.info-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
}

.info-item {
    padding: 15px;
    background: #f8f9fa;
    border-radius: 8px;
    border-left: 4px solid #2874a6;
}

.grades-table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
}

.grades-table th {
    background: #1a5276;
    color: white;
    padding: 12px;
}

.grades-table td {
    padding: 12px;
    border-bottom: 1px solid #ddd;
}

.loading {
    display: none;
    text-align: center;
    padding: 30px;
}

/* Ensure footer stays fixed at bottom */
body {
    padding-bottom: 90px;
}

.error-message {
    display: none;
    color: #dc3545;
    background: #f8d7da;
    padding: 10px;
    border-radius: 5px;
    margin-top: 10px;
}
</style>
</head>

<body>

<!-- TOP NAV -->
<div class="top-nav">
    <div class="menu-toggle" id="menuToggle">
        <i class="fas fa-bars"></i>
    </div>

    <div class="nav-marquee">
        <marquee><h1>KEMZ ONLINE SERVICES</h1></marquee>
    </div>

    <div class="nav-logo">
        <img src="Kemz_logo.png" alt="Kemz Logo">
    </div>
</div>

<!-- SIDE NAV -->
<div class="nav-panel" id="navPanel">
    <a href="index.html"><i class="fas fa-home"></i> Home</a>
    <a href="about.html"><i class="fas fa-info-circle"></i> About Us</a>
    <a href="location.html"><i class="fas fa-map-marker-alt"></i> Location & Contacts</a>
    <a href="services.html"><i class="fas fa-concierge-bell"></i> Services Offered</a>
    <a href="staff.html"><i class="fas fa-users"></i> Staff Members</a>
    <a href="updates.html"><i class="fas fa-bullhorn"></i> Latest Updates</a>
    <a href="registration.html"><i class="fas fa-file-signature"></i> Online Registration</a>
    <a href="results-portal.html"><i class="fas fa-poll"></i> Online Results</a>
    <a href="elearning.html"><i class="fas fa-laptop-code"></i> E-Learning Materials</a>
    <a href="online-classes.html"><i class="fas fa-video"></i> Online Classes</a>
    <a href="help.html"><i class="fas fa-question-circle"></i> Help</a>
</div>

<!-- HEADER -->
<header>
<div class="container">
<div class="header-content">
    <img src="Kemz_logo.png" class="logo-img">
    <h1>KEMZ ACADEMIC CENTRE</h1>
    <p>Hard Work Brings Success!</p>
</div>
</div>
</header>

<!-- MAIN CONTENT -->
<div class="container">
<h2 class="section-title">RESULTS PORTAL</h2>

<div id="formContainer">
<div class="form-group">
<label>Student ID Number</label>
<input type="text" id="studentId">
</div>

<div class="form-group">
<label>Academic Term</label>
<select id="term">
<option value="">Select Term</option>
<option value="Term 1">Term 1</option>
<option value="Term 2">Term 2</option>
<option value="Term 3">Term 3</option>
</select>
</div>

<div class="form-group">
<label>Academic Year</label>
<select id="year">
<option value="">Select Year</option>
<option value="2026">2026</option>
<option value="2025">2025</option>
</select>
</div>

<button class="btn-submit" id="fetchResults">
<i class="fas fa-search"></i> Fetch Results
</button>

<div class="error-message" id="errorMessage"></div>
</div>

<div class="loading" id="loading">
<p>Fetching results...</p>
</div>

<div class="result-container" id="resultContainer">
<h3>Academic Results</h3>

<div class="info-grid">
<div class="info-item"><strong>ID:</strong> <span id="resultId"></span></div>
<div class="info-item"><strong>Name:</strong> <span id="resultName"></span></div>
<div class="info-item"><strong>Class:</strong> <span id="resultClass"></span></div>
<div class="info-item"><strong>Term:</strong> <span id="resultTerm"></span> <span id="resultYear"></span></div>
</div>

<table class="grades-table">
<thead>
<tr>
<th>Subject</th>
<th>Score</th>
<th>Max Mark</th>
</tr>
</thead>
<tbody id="gradesBody"></tbody>
</table>

<p><strong>Total Score:</strong> <span id="totalMarks"></span></p>
<p><strong>Position:</strong> <span id="position"></span></p>
<p><strong>Overall Comment:</strong> <span id="overallComment"></span></p>

<button class="btn-submit" id="newSearch">New Search</button>
</div>
</div>

<!-- FOOTER -->
<div class="fixed-footer">
Â© 2025 KEMZ ACADEMIC CENTRE | Powered By Kemz Online Services
</div>

<script src="script.js"></script>

<script>
const fetchBtn = document.getElementById("fetchResults");
const newSearchBtn = document.getElementById("newSearch");

const formContainer = document.getElementById("formContainer");
const loading = document.getElementById("loading");
const resultContainer = document.getElementById("resultContainer");
const errorMessage = document.getElementById("errorMessage");

fetchBtn.addEventListener("click", () => {
    const studentId = document.getElementById("studentId").value.trim();
    const term = document.getElementById("term").value;
    const year = document.getElementById("year").value;

    if (!studentId || !term || !year) {
        errorMessage.textContent = "Please fill in all fields.";
        errorMessage.style.display = "block";
        return;
    }

    errorMessage.style.display = "none";
    formContainer.style.display = "none";
    loading.style.display = "block";

    const url = "https://script.google.com/macros/s/AKfycbyXdVXUV0niw-zutbF79KpSXctgEpP91a_lr2SWiMI0e6fOoAtE7dIo0mO0_2Ii7HNyzg/exec"
              + "?studentId=" + encodeURIComponent(studentId)
              + "&term=" + encodeURIComponent(term)
              + "&year=" + encodeURIComponent(year);

    fetch(url)
      .then(res => res.json())
      .then(data => {
          loading.style.display = "none";

          if (data.error) {
              formContainer.style.display = "block";
              errorMessage.textContent = data.error;
              errorMessage.style.display = "block";
              return;
          }

          // Fill student info
          document.getElementById("resultId").textContent = data.student.studentId;
          document.getElementById("resultName").textContent = data.student.name;
          document.getElementById("resultClass").textContent = data.student.class;
          document.getElementById("resultTerm").textContent = data.student.term;
          document.getElementById("resultYear").textContent = data.student.year;

          document.getElementById("totalMarks").textContent = data.student.total;
          document.getElementById("position").textContent = data.student.position;
          document.getElementById("overallComment").textContent = data.student.comment;

          // Fill subjects table
          const gradesBody = document.getElementById("gradesBody");
          gradesBody.innerHTML = "";

          data.results.forEach(row => {
              const tr = document.createElement("tr");
              tr.innerHTML = `
                  <td>${row.subject}</td>
                  <td>${row.score}</td>
                  <td>${row.maxMark}</td>
              `;
              gradesBody.appendChild(tr);
          });

          resultContainer.style.display = "block";
      })
      .catch(err => {
          loading.style.display = "none";
          formContainer.style.display = "block";
          errorMessage.textContent = "Connection error. Try again later.";
          errorMessage.style.display = "block";
      });
});

newSearchBtn.addEventListener("click", () => {
    resultContainer.style.display = "none";
    formContainer.style.display = "block";
});
</script>

</body>
</html>